<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GSU Charge Run</title>
  <link rel="icon" href="GSU_LOGO.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet" />
  <style>
    body {
      margin: 0;
      font-family: 'Orbitron', sans-serif;
      background: #000;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    header {
      text-align: center;
    }
    header h1 {
      font-size: 3rem;
      color: #e60023;
    }
    header h2 {
      font-size: 1.5rem;
      color: #00ffee;
      margin-top: -10px;
    }
    #gameArea {
      text-align: center;
      margin-top: 20px;
    }
    #hud {
      display: flex;
      justify-content: center;
      gap: 25px;
      flex-wrap: wrap;
      margin-bottom: 15px;
      font-size: 1.1rem;
    }
    #gameCanvas {
      display: grid;
      grid-template-columns: repeat(10, 30px);
      grid-template-rows: repeat(12, 30px);
      border: 3px solid #e60023;
      box-shadow: 0 0 20px #e60023cc;
      background-image:
        linear-gradient(to right, rgba(255, 255, 255, 0.1) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
      background-size: 30px 30px;
      margin-bottom: 20px;
    }
    .grid-cell {
      width: 30px;
      height: 30px;
      position: relative;
    }
    .grid-cell div {
      width: 100%;
      height: 100%;
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      position: absolute;
    }
    .controller {
      background-image: url('GSU_LOGO.png');
      z-index: 5;
      transform: scale(2.2); /* Very much enlarged */
    }
    .battery {
      background-image: url('https://upload.wikimedia.org/wikipedia/commons/4/44/Battery_icon_green.svg');
      z-index: 1;
    }
    .hazard {
      background-image: url('https://upload.wikimedia.org/wikipedia/commons/2/2b/Fire_icon.svg');
      z-index: 1;
    }
    #startGameBtn, #nextSurgeBtn {
      padding: 10px 22px;
      font-size: 1.1rem;
      background-color: #00ffee;
      color: black;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 15px;
    }
    #startGameBtn {
      background-color: #e60023;
      color: #fff;
    }
    footer {
      margin-top: 30px;
      font-size: 0.9em;
      color: #666;
    }
  </style>
</head>
<body>
  <header>
    <h1>GSU DATA SURGE</h1>
    <h2>CONTROLLER CORE</h2>
  </header>

  <div id="gameArea">
    <div id="hud">
      <span id="goalText">Collect: üîã</span>
      <span id="avoidText">Avoid: üî•</span>
      <span id="timer">‚è±Ô∏è Time Left: 30</span>
      <span id="powerBar">Surge power: ‚ö°</span>
      <span id="lives">Life Count: ‚ù§Ô∏è ‚ù§Ô∏è ‚ù§Ô∏è</span>
      <span id="surgeLevel">Surge Level: 0</span>
    </div>

    <div id="gameCanvas"></div>
    <button id="startGameBtn">‚ñ∂Ô∏è Start GSU Charge Run</button>
    <button id="nextSurgeBtn" style="display: none;">‚ñ∂Ô∏è Start Next Surge</button>
  </div>

  <footer>Built for GameSync Union ‚Äî GSU Charge Run‚Ñ¢</footer>

  <script>
    const grid = document.getElementById("gameCanvas");
    const powerBar = document.getElementById("powerBar");
    const livesEl = document.getElementById("lives");
    const timerEl = document.getElementById("timer");
    const goalText = document.getElementById("goalText");
    const avoidText = document.getElementById("avoidText");
    const surgeLevelEl = document.getElementById("surgeLevel");
    const startGameBtn = document.getElementById("startGameBtn");
    const nextSurgeBtn = document.getElementById("nextSurgeBtn");

    let lives = 3;
    let power = 0;
    let playerX = 5;
    let playerY = 6;
    let collected = 0;
    let timer = 0;
    let interval;
    let requiredBatteries = 10;
    let surgeLevel = 0;
    let requiredHazards = 20;

    function updateUI() {
      powerBar.textContent = `Surge power: ${'‚ö°'.repeat(power)}`;
      livesEl.textContent = `Life Count: ${'‚ù§Ô∏è '.repeat(lives)}`;
      goalText.textContent = `üîã Collect ${requiredBatteries} batteries!`;
      avoidText.textContent = `üî• Avoid ${requiredHazards} fires`;
      surgeLevelEl.textContent = `Surge Level: ${surgeLevel}`;
    }

    function drawGrid() {
      grid.innerHTML = '';
      for (let y = 0; y < 12; y++) {
        for (let x = 0; x < 10; x++) {
          const cell = document.createElement('div');
          cell.className = 'grid-cell';
          cell.dataset.x = x;
          cell.dataset.y = y;
          grid.appendChild(cell);
        }
      }
    }

    function fillGridWithItems() {
      for (let i = 0; i < requiredBatteries; i++) spawnRandomItem('battery');
      for (let i = 0; i < requiredHazards; i++) spawnRandomItem('hazard');
    }

    function spawnRandomItem(type) {
      const x = Math.floor(Math.random() * 10);
      const y = Math.floor(Math.random() * 12);
      const cell = [...grid.children].find(c => c.dataset.x == x && c.dataset.y == y);
      if (cell) {
        const taken = cell.querySelector('.battery, .hazard, .controller');
        if (!taken) {
          const item = document.createElement('div');
          item.className = type;
          cell.appendChild(item);
        } else {
          spawnRandomItem(type); // try again if occupied
        }
      }
    }

    function movePlayer(dx, dy) {
      const newX = Math.max(0, Math.min(9, playerX + dx));
      const newY = Math.max(0, Math.min(11, playerY + dy));
      playerX = newX;
      playerY = newY;
      renderPlayer();
      checkCollision();
    }

    function renderPlayer() {
      [...grid.children].forEach(cell => {
        const existing = cell.querySelector('.controller');
        if (existing) existing.remove();
      });
      const cell = [...grid.children].find(c => c.dataset.x == playerX && c.dataset.y == playerY);
      if (cell) {
        const controller = document.createElement('div');
        controller.className = 'controller';
        cell.appendChild(controller);
      }
    }

    function checkCollision() {
      const cell = [...grid.children].find(c => c.dataset.x == playerX && c.dataset.y == playerY);
      const item = cell.querySelector('.battery, .hazard');
      if (item) {
        if (item.classList.contains('battery')) {
          collected++;
          power++;
        } else if (item.classList.contains('hazard')) {
          lives--;
          alert('üî• You touched fire and lost a life!');
          if (lives <= 0) return endGame(false, 'üíÄ Burned out! Game Over!');
        }
        item.remove();
        updateUI();

        if (collected >= requiredBatteries) {
          clearInterval(interval);
          alert("üéâ FULL SYNC ‚Äì SURGE ACTIVATED!");
          nextSurgeBtn.style.display = "inline-block";
        }
      }
    }

    function startTimer() {
      timer = 30 * (surgeLevel + 1);
      timerEl.textContent = `‚è±Ô∏è Time Left: ${timer}`;
      interval = setInterval(() => {
        timer--;
        timerEl.textContent = `‚è±Ô∏è Time Left: ${timer}`;
        if (timer <= 0) {
          clearInterval(interval);
          lives--;
          if (lives <= 0) return endGame(false, '‚è∞ Time‚Äôs up and lives exhausted. Game Over!');
          alert('‚è∞ Time‚Äôs up! You lost a life.');
          startSurge(); // retry same level
        }
      }, 1000);
    }

    function endGame(won, msg) {
      clearInterval(interval);
      alert(msg);
      nextSurgeBtn.style.display = "none";
      startGameBtn.style.display = "inline-block";
      lives = 3;
      power = 0;
      surgeLevel = 0;
    }

    function startSurge() {
      nextSurgeBtn.style.display = "none";
      startGameBtn.style.display = "none";
      collected = 0;
      requiredBatteries = (surgeLevel + 1) * 10;
      requiredHazards = requiredBatteries + 10;
      drawGrid();
      fillGridWithItems();
      updateUI();
      renderPlayer();
      startTimer();
    }

    startGameBtn.addEventListener("click", () => {
      lives = 3;
      power = 0;
      surgeLevel = 0;
      startSurge();
    });

    nextSurgeBtn.addEventListener("click", () => {
      surgeLevel++;
      startSurge();
    });

    document.addEventListener("keydown", (e) => {
      if (["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight"].includes(e.key)) {
        if (e.key === "ArrowUp") movePlayer(0, -1);
        else if (e.key === "ArrowDown") movePlayer(0, 1);
        else if (e.key === "ArrowLeft") movePlayer(-1, 0);
        else if (e.key === "ArrowRight") movePlayer(1, 0);
      }
    });
  </script>
</body>
</html>
