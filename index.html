<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GameSync Union</title>
  <link rel="icon" href="GSU_Logo.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600&family=Roboto&display=swap" rel="stylesheet" />
  <style>
    :root {
      --gsu-red: #e60023;
      --black-main: #191818;
      --black-faded: #1F1F1F;
      --white-text: #FFFFFF;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Roboto', sans-serif;
      background-color: var(--black-main);
      color: var(--white-text);
    }
    header {
      background-color: var(--black-faded);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
    }
    .logo {
      display: flex;
      align-items: center;
    }
    .logo img {
      height: 50px;
      margin-right: 1rem;
    }
    .logo-text {
      font-size: 1.5rem;
      font-family: 'Montserrat', sans-serif;
      color: var(--white-text);
    }
    nav {
      display: flex;
      gap: 1rem;
    }
    nav a {
      color: var(--white-text);
      text-decoration: none;
      font-family: 'Montserrat', sans-serif;
    }
    nav a:hover {
      color: var(--gsu-red);
    }
    .main-container {
      padding: 2rem;
    }
    .input-field, .btn {
      width: 100%;
      margin: 0.5rem 0;
      padding: 0.7rem;
      border-radius: 6px;
      border: none;
    }
    .input-field {
      background: #2a2a2a;
      color: white;
    }
    .btn {
      background-color: var(--gsu-red);
      color: white;
      cursor: pointer;
      font-weight: bold;
      font-family: 'Montserrat', sans-serif;
    }
    .btn:hover {
      opacity: 0.85;
    }
    #createAccountModal {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 999;
      display: none;
    }
    #createAccountModal .modal-box {
      background: #1f1f1f;
      padding: 2rem;
      border-radius: 12px;
      width: 90%;
      max-width: 600px;
    }
    .profile-display p {
      margin: 0.5rem 0;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <img src="GSU_LOGO.png" alt="GSU Logo" />
      <div class="logo-text">GAMESYNC UNION</div>
    </div>
    <nav>
      <a href="#">Home</a>
      <a href="#">Games</a>
      <a href="#">Guides</a>
      <a href="#">Uploads</a>
    </nav>
  </header>

  <div class="main-container">
    <div class="box">
      <h2>Login to GameSync</h2>
      <input type="email" id="loginEmail" class="input-field" placeholder="Email" />
      <input type="password" id="loginPassword" class="input-field" placeholder="Password" />
      <button class="btn" onclick="signIn()">Sign In</button>
      <p style="margin-top:1rem;">No account? <a href="#" onclick="showCreateModal()" style="color: var(--gsu-red);">Create One</a></p>
    </div>

    <div class="box profile-display">
      <h2>Your Profile</h2>
      <p id="displayUsername">Username: —</p>
      <p id="displayConsole">Console: —</p>
      <p id="displayTrophies">Trophies: —</p>
      <p id="displayGames">Recent Games: —</p>
    </div>
  </div>

  <!-- Modal -->
  <div id="createAccountModal">
    <div class="modal-box">
      <h2 style="text-align:center; color:var(--gsu-red);">Create Account</h2>
      <input type="email" id="regEmail" class="input-field" placeholder="Email" />
      <input type="password" id="regPassword" class="input-field" placeholder="Password" />
      <input type="text" id="regUsername" class="input-field" placeholder="Username" />
      <input type="text" id="regConsole" class="input-field" placeholder="Console" />
      <input type="text" id="regTrophies" class="input-field" placeholder="Trophy Stats" />
      <input type="text" id="regRecent" class="input-field" placeholder="Recent Games Played" />
      <button class="btn" onclick="register()">Create Account</button>
      <button class="btn" style="background: gray;" onclick="document.getElementById('createAccountModal').style.display='none'">Cancel</button>
    </div>
  </div>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBA7aIUj919ub7QtkQkAp-xv4XC0tzmSCI",
    authDomain: "gamesync-union.firebaseapp.com",
    projectId: "gamesync-union",
    storageBucket: "gamesync-union.appspot.com",
    messagingSenderId: "488911705365",
    appId: "qBMwNM2oGO30dVBhODSC"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // Show modal
  window.showCreateModal = () => {
    document.getElementById("createAccountModal").style.display = "flex";
  };

  // 🔐 Create New User + Save to Firestore
  window.register = async () => {
    const email = document.getElementById("regEmail").value.trim();
    const password = document.getElementById("regPassword").value;
    const username = document.getElementById("regUsername").value.trim();
    const console = document.getElementById("regConsole").value.trim();
    const trophies = document.getElementById("regTrophies").value.trim();
    const recent = document.getElementById("regRecent").value.trim();

    try {
      const userCred = await createUserWithEmailAndPassword(auth, email, password);
      const uid = userCred.user.uid;

      await setDoc(doc(db, "users", uid), {
        email,
        username,
        console,
        trophies,
        recentGames: recent
      });

      alert("Account created!");
      document.getElementById("createAccountModal").style.display = "none";
      loadProfile(uid);
    } catch (err) {
      alert("Failed to create account: " + err.message);
    }
  };

  // 🔓 Sign In
  window.signIn = async () => {
    const email = document.getElementById("loginEmail").value;
    const password = document.getElementById("loginPassword").value;

    try {
      const userCred = await signInWithEmailAndPassword(auth, email, password);
      const uid = userCred.user.uid;
      loadProfile(uid);
    } catch (err) {
      alert("Login failed: " + err.message);
    }
  };

  // 🔍 Load profile
  async function loadProfile(uid) {
    const snap = await getDoc(doc(db, "users", uid));
    if (snap.exists()) {
      const data = snap.data();
      document.getElementById("displayUsername").textContent = `Username: ${data.username}`;
      document.getElementById("displayConsole").textContent = `Console: ${data.console}`;
      document.getElementById("displayTrophies").textContent = `Trophies: ${data.trophies}`;
      document.getElementById("displayGames").textContent = `Recent Games: ${data.recentGames}`;
    }
  }

  // 🔁 Auto load if signed in
  onAuthStateChanged(auth, (user) => {
    if (user) loadProfile(user.uid);
  });
</script>
<div class="box" id="auth-box">
  <h2>Sign In</h2>
  <input type="text" id="loginEmail" class="input-field" placeholder="Email" />
  <input type="password" id="loginPassword" class="input-field" placeholder="Password" />
  <button class="btn" onclick="signIn()">Sign In</button>
  <p style="text-align:center; margin-top:0.6rem;">
    Not a member? <a href="#" style="color: #e60023;" onclick="showCreateModal()">Create Account</a>
  </p>
</div>
<div id="createAccountModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:9999; align-items:center; justify-content:center;">
  <div style="background:#1f1f1f; padding:2rem; border-radius:12px; width:95%; max-width:620px;">
    <h2 style="color:var(--gsu-red); text-align:center;">Create GSU Account</h2>
    <input type="text" id="regEmail" class="input-field" placeholder="GSU Email" />
    <input type="password" id="regPassword" class="input-field" placeholder="Create Password" />
    <input type="text" id="regUsername" class="input-field" placeholder="Username" />
    <input type="text" id="regConsole" class="input-field" placeholder="Console (PS5, Xbox, etc.)" />
    <input type="text" id="regTrophies" class="input-field" placeholder="Trophy Stats" />
    <input type="text" id="regRecent" class="input-field" placeholder="Recent Games Played (comma separated)" />

    <div style="display:flex; justify-content:space-between; gap:1rem; margin-top:1rem;">
      <button class="btn" onclick="register()">Create Account</button>
      <button class="btn" style="background:#888;" onclick="document.getElementById('createAccountModal').style.display='none'">Cancel</button>
    </div>
  </div>
</div>
<div class="box">
  <h2>Your Profile</h2>
  <p id="displayUsername">Username:</p>
  <p id="displayConsole">Console:</p>
  <p id="displayTrophies">Trophies:</p>
  <p id="displayGames">Recent Games:</p>
</div>
