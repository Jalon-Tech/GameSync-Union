<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>GSU Command Strike ‚Äî Solo</title>
<link rel="icon" href="GSU_LOGO.png" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet" />
<style>
  :root{ --gsu-red:#e60023; --bg:#000; --fg:#fff; --muted:#c7c7c7 }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:'Orbitron',sans-serif; background:var(--bg); color:var(--fg);
    display:flex; flex-direction:column; align-items:center; padding:16px; gap:12px;
  }
  header{display:flex; flex-direction:column; align-items:center; gap:8px}
  nav{display:flex; gap:10px; flex-wrap:wrap; justify-content:center}
  nav a{color:#fff; text-decoration:none; background:var(--gsu-red); padding:8px 12px; border-radius:10px}

  .wrap{
    width:min(960px,96vw); border:3px solid var(--gsu-red); border-radius:16px; padding:14px;
    box-shadow:0 0 18px #e60023cc, inset 0 0 18px #e6002326;
    background:linear-gradient(#0a0a0a,#000);
  }
  .wrap.shake{animation:shake .3s ease}
  @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-4px)}50%{transform:translateX(4px)}75%{transform:translateX(-4px)}}

  .hud{display:grid; grid-template-columns:repeat(5,1fr); gap:8px; margin-bottom:10px; font-size:clamp(.8rem,2vw,1rem)}
  .pill{background:#111; border:1px solid #2a2a2a; border-radius:10px; padding:8px; text-align:center}
  .pill strong{color:var(--gsu-red)}

  .panel{border:1px solid #2a2a2a; border-radius:12px; padding:12px; background:#0b0b0b; display:flex; flex-direction:column; gap:12px;}

  /* FX Stage */
  .stage{position:relative; height:180px; border:1px solid #333; border-radius:12px; background:#0f0f0f; overflow:hidden}
  .fx{position:absolute; inset:0; pointer-events:none}
  .target{position:absolute; right:18px; top:24px; font-size:52px; filter:drop-shadow(0 0 8px #fff)}
  .target.hit{filter:drop-shadow(0 0 14px #e60023)}
  .logoFly{position:absolute; width:64px; left:-90px; top:120px; animation:fly .8s ease-out forwards}
  @keyframes fly{from{left:-90px; top:120px; transform:rotate(-15deg)} to{left:calc(100% - 120px); top:26px; transform:rotate(10deg)}}
  .boom{position:absolute; right:12px; top:20px; font-size:64px; opacity:0; animation:pop .45s ease-out forwards}
  @keyframes pop{from{transform:scale(.5); opacity:.2} to{transform:scale(1.2); opacity:1}}

  .big-next{text-align:center; font-size:clamp(1.2rem,4.5vw,1.8rem); background:#0f0f0f; border:1px solid #333; border-radius:12px; padding:12px;}
  .cmd{background:#0f0f0f; border:1px dashed #444; border-radius:12px; padding:12px; min-height:80px; display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:center;}
  .token{padding:10px 12px; border-radius:10px; background:#171717; border:1px solid #333; font-size:1.05rem}
  .token.pending{outline:2px solid #ffae00}
  .token.ok{outline:2px solid #29d07a}
  .token.bad{outline:2px solid #d02121}

  .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:center}
  .btn{border:none; background:var(--gsu-red); color:#fff; padding:10px 16px; border-radius:10px; cursor:pointer; box-shadow:0 0 10px #e60023aa; font-weight:700}
  .btn:disabled{opacity:.5; cursor:not-allowed}
  .hint{color:var(--muted); text-align:center; font-size:.95rem}

  /* On-screen controls */
  .controls{margin-top:6px; display:grid; grid-template-columns:repeat(3,64px); gap:8px; justify-content:center; align-items:center; user-select:none}
  .key{width:64px; height:64px; border-radius:12px; background:#121212; border:1px solid #333; display:flex; align-items:center; justify-content:center; font-size:1.2rem; cursor:pointer; box-shadow:0 0 8px rgba(255,255,255,.05)}
  .key:active{filter:brightness(1.2)}
  .letters{display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-top:6px}
  .letters .key{width:48px; height:44px}

  footer{opacity:.7; font-size:.85rem}
  @media (max-width:720px){ .hud{grid-template-columns:repeat(2,1fr)} }
</style>
</head>
<body>
  <header>
    <img src="GSU_LOGO.png" alt="GSU" style="max-width:96px">
    <div>GAMESYNC UNION</div>
    <nav>
      <a href="index.html">Home</a>
      <a href="games.html">Games</a>
      <a href="uploads.html">GSU Player Lounge</a>
    </nav>
  </header>

  <section class="wrap" id="wrap">
    <h1 style="margin:6px 0 10px 6px;">GSU COMMAND STRIKE ‚Äî SOLO</h1>
    <div class="hud">
      <div class="pill">üìú Round <strong id="round">1</strong>/5</div>
      <div class="pill">üéØ Progress <strong id="progress">0</strong>%</div>
      <div class="pill">‚è± Time <strong id="time">0</strong>ms</div>
      <div class="pill">‚úÖ Accuracy <strong id="acc">0</strong>%</div>
      <div class="pill">üî• Streak <strong id="streak">0</strong></div>
    </div>

    <div class="panel">
      <!-- FX Stage -->
      <div class="stage" id="stage">
        <div class="fx" id="fx"></div>
      </div>

      <div class="big-next">Next: <span id="nextToken">‚Äî</span></div>
      <div class="cmd" id="cmd"></div>

      <div class="row">
        <button class="btn" id="start">‚ñ∂ Start Drill</button>
        <button class="btn" id="next" disabled>‚è≠ Next Pattern</button>
        <button class="btn" id="restart" disabled>üîÅ Restart</button>
      </div>

      <div class="hint">Arrows = directions ‚Ä¢ Letters = press the same letter (A/S/D/Q/E/F/J/K/L/Z/X/C)</div>

      <!-- On-screen controls -->
      <div class="controls" aria-label="D-Pad">
        <div></div><div class="key" data-sym="‚Üë">‚Üë</div><div></div>
        <div class="key" data-sym="‚Üê">‚Üê</div><div class="key" data-sym="‚Üì">‚Üì</div><div class="key" data-sym="‚Üí">‚Üí</div>
      </div>
      <div class="letters" id="lettersRow"></div>
    </div>
  </section>

  <footer>Built for GameSync Union ‚Äî GSU Command Strike‚Ñ¢</footer>

<script>
/* ---------------- Tokens & Pattern Gen (variety, no immediate repeats) ---------------- */
const DIR = ["‚Üë","‚Üì","‚Üê","‚Üí"];
const LETTER_TOKENS = ["A","S","D","Q","E","F","J","K","L","Z","X","C"];

function pick(arr){ return arr[Math.floor(Math.random()*arr.length)] }
function genPattern(round){
  const len = [4,5,5,6,7][Math.min(4, round-1)];
  const toks = [];
  for (let i=0;i<len;i++){
    const pool = Math.random() < 0.5 ? DIR : LETTER_TOKENS;
    let t = pick(pool);
    if (i>0 && t===toks[i-1]){ // avoid immediate repeat
      const alt = pool.filter(x=>x!==t);
      t = pick(alt);
    }
    toks.push(t);
  }
  return toks;
}

/* ---------------- State & DOM ---------------- */
const wrap = document.getElementById('wrap');
const stage = document.getElementById('stage');
const fx = document.getElementById('fx');
const roundEl = document.getElementById('round');
const progEl  = document.getElementById('progress');
const timeEl  = document.getElementById('time');
const accEl   = document.getElementById('acc');
const streakEl= document.getElementById('streak');
const cmdEl   = document.getElementById('cmd');
const nextTok = document.getElementById('nextToken');
const startBtn= document.getElementById('start');
const nextBtn = document.getElementById('next');
const restartBtn=document.getElementById('restart');
const lettersRow = document.getElementById('lettersRow');

let game = null;
function newGame(){
  return { round:1, maxRounds:5, tokens:[], idx:0, start:0, end:0, hits:0, presses:0, streak:0, active:false };
}

/* Build on-screen letters */
lettersRow.innerHTML = LETTER_TOKENS.map(ch=>`<div class="key" data-sym="${ch}">${ch}</div>`).join("");

function renderCmd(){
  cmdEl.innerHTML = game.tokens.map((t,i)=>{
    let cls = "token";
    if (i < game.idx) cls += " ok";
    else if (i === game.idx) cls += " pending";
    return `<div class="${cls}">${t}</div>`;
  }).join("");
  nextTok.textContent = game.tokens[game.idx] ?? "‚Äî";
}

function setHUD(){
  roundEl.textContent = game.round;
  const p = game.tokens.length ? Math.floor(100 * (game.idx / game.tokens.length)) : 0;
  progEl.textContent = p;
  const t = game.end && game.start ? (game.end - game.start) : (performance.now() - game.start);
  timeEl.textContent = game.active ? Math.floor(t) : Math.floor(game.end - game.start);
  const acc = game.presses ? Math.floor(100 * (game.hits / game.presses)) : 0;
  accEl.textContent = acc;
  streakEl.textContent = game.streak;
}

function startRound(){
  game.active = true;
  game.tokens = genPattern(game.round);
  game.idx = 0; game.hits = 0; game.presses = 0; game.streak = 0;
  game.start = performance.now(); game.end = 0;
  renderCmd(); setHUD();
  startBtn.disabled = true; nextBtn.disabled = true; restartBtn.disabled = false;
  // Reset stage visual
  fx.innerHTML = '';
  // Spawn fresh target
  const t = document.createElement('div');
  t.className = 'target';
  t.textContent = 'üéÆ';
  fx.appendChild(t);
}

function endRound(){
  game.active = false;
  game.end = performance.now();
  setHUD();
  // Awesome strike FX
  playStrike();
  if (game.round >= game.maxRounds){
    startBtn.disabled = false; startBtn.textContent="üîÅ New Drill";
    nextBtn.disabled = true;
  } else {
    nextBtn.disabled = false;
  }
}

function nextRound(){ game.round++; startRound(); }

/* ---------------- Input Handling (letters fixed) ---------------- */
function apply(sym){
  if (!game?.active) return;
  game.presses++;
  const need = game.tokens[game.idx];

  if (sym === need){
    game.hits++; game.streak = Math.min(999, game.streak+1);
    game.idx++;
    renderCmd(); setHUD();
    if (game.idx >= game.tokens.length){ endRound(); }
  } else {
    game.streak = 0;
    const tokenEls = cmdEl.querySelectorAll('.token');
    const cur = tokenEls[game.idx];
    if (cur){ cur.classList.add('bad'); setTimeout(()=>cur.classList.remove('bad'), 150); }
    setHUD();
  }
}

/* Capture arrows + ANY letter reliably (works across layouts) */
function onKey(e){
  // prevent page scroll on arrows/space
  if (["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," "].includes(e.key)) e.preventDefault();
  if (!game) return;

  let sym = null;
  if (e.key === "ArrowUp") sym = "‚Üë";
  else if (e.key === "ArrowDown") sym = "‚Üì";
  else if (e.key === "ArrowLeft") sym = "‚Üê";
  else if (e.key === "ArrowRight") sym = "‚Üí";
  else if (/^[a-z]$/i.test(e.key)) sym = e.key.toUpperCase(); // letters!

  if (sym){
    // Only accept letters we actually use
    if (DIR.includes(sym) || LETTER_TOKENS.includes(sym)) apply(sym);
  }
}
window.addEventListener('keydown', onKey);

/* On-screen buttons (mobile/touch) */
document.querySelectorAll('.key[data-sym]').forEach(k=>{
  k.addEventListener('click', ()=> apply(k.getAttribute('data-sym')));
});

/* Buttons */
startBtn.addEventListener('click', ()=>{ if (!game) game = newGame(); else game.round = 1; startRound(); });
nextBtn.addEventListener('click', nextRound);
restartBtn.addEventListener('click', ()=>{ if (game) startRound(); });

/* ---------------- Strike Animation ---------------- */
function playStrike(){
  const logo = document.createElement('img');
  logo.src = 'GSU_LOGO.png';
  logo.alt = 'GSU';
  logo.className = 'logoFly';

  const target = fx.querySelector('.target') || (()=>{const t=document.createElement('div');t.className='target';t.textContent='üéÆ';fx.appendChild(t);return t;})();
  fx.appendChild(logo);

  logo.addEventListener('animationend', ()=>{
    target.classList.add('hit');
    // Boom!
    const boom = document.createElement('div');
    boom.className = 'boom';
    boom.textContent = 'üí•';
    fx.appendChild(boom);
    // Screen shake
    wrap.classList.add('shake');
    setTimeout(()=> wrap.classList.remove('shake'), 400);
    // Cleanup FX
    setTimeout(()=> { logo.remove(); target.remove(); boom.remove(); }, 900);
  }, {once:true});
}
</script>
</body>
</html>
