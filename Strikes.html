<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>GSU Command Strike ‚Äî Split Duel</title>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet" />
<style>
:root{
  --gsu-red:#e60023; --bg: #141416; --fg:#fff; --muted:#babecb;
}
html, body { margin:0; padding:0; height:100%; background:var(--bg); color:var(--fg); font-family:'Orbitron',sans-serif; }
.split-container {
  display: flex; width: 100vw; max-width: 940px; margin: 0 auto;
  min-height: 330px; height:400px; border-radius:16px; overflow:hidden;
  box-shadow:0 2px 26px #470a1230;
  border:3px solid var(--gsu-red);
  background:linear-gradient(90deg,#1a1a1d 45%, #10101b 55%);
}
.split-side {
  flex: 1;
  display: flex; flex-direction:column; align-items:center; justify-content:space-between;
  padding: 0 12px 12px 12px;
  position:relative;
  min-width:0; min-height: 0;
}
.split-side.left { background: #181820; border-right:2px solid #e6002335; }
.split-side.right { background: #191719; }
h2 { text-align:center; margin:5px 0 4px 0; font-size:1.21em; letter-spacing:2px; }
.stage-outer {
  border:1.5px solid #2a2a3a; border-radius:12px; margin-bottom:8px;
  height:130px; background:#18171c; width:100%; position: relative; overflow:hidden;
  display: flex; align-items:center; justify-content:center;
}
.fx{position:absolute;inset:0;pointer-events:none;}
.target{position:absolute; font-size:41px; filter:drop-shadow(0 0 8px #fff); transition: transform .26s cubic-bezier(.33,1.2,.68,1);}
.target.hit{filter:drop-shadow(0 0 14px #e60023);}
.controller{position:absolute; width:58px; will-change:transform; filter:drop-shadow(0 0 8px #e6002366);}
.boom{position:absolute; font-size:50px; opacity:0;}
.spark{position:absolute; width:8px; height:8px; border-radius:50%; background:radial-gradient(circle,#fff 0 47%, rgba(255,255,255,.2) 60%, transparent 75%);
  box-shadow:0 0 10px rgba(255,255,255,.38);}
.confetti{position:absolute; width:8px; height:12px; will-change:transform; opacity:.96}
.cmd {
  min-height: 40px; display:flex; justify-content:center; align-items:center; gap:7px;
  margin-bottom:6px;
}
.token{padding:7px 11px; margin:1px; border-radius:8px; background:#212123; border:1px solid #393a3c; font-size:1.0em;}
.token.pending{outline:2px solid #ffae00;}
.token.ok{outline:2px solid #29d07a;}
.token.bad{outline:2px solid #d02121;}
.hud{ font-size:.96em; display:flex; gap:11px; margin-bottom:4px;}
.pill{background:#222228; border:1px solid #35363a; border-radius:7px; padding:4px 7px; text-align:center; min-width:48px;}
.pill strong{color:var(--gsu-red);}
.leader { letter-spacing:1px; margin:0; font-size:.98em; }
.letters{margin-top:9px; display:flex; flex-wrap:wrap; gap:8px; justify-content:center;}
.key{width:45px; height:36px; border-radius:8px; background:#25242b; border:1.2px solid #2a2d33; display:inline-flex; align-items:center; justify-content:center; font-size:1.08em; cursor:pointer; margin-bottom:4px;}
.key:active{filter:brightness(1.2);}
.directions{margin: 1px 0 7px 0; display:flex; gap:8px; justify-content:center;}
.btnRow {display:flex; gap:10px;justify-content:center; margin:10px 0;}
.btn{border:none; background:var(--gsu-red); color:#fff; padding:8px 16px; border-radius:9px; cursor:pointer; font-weight:700; font-size:1.1em;}
.btn:disabled{opacity:.55; cursor:not-allowed;}
.overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;pointer-events:none;}
.banner{padding:8px 16px; border:2px solid #fff; border-radius:14px; background:rgba(230,0,35,.13); text-shadow:0 0 12px rgba(255,255,255,.34); font-size:clamp(1.18rem,3vw,1.35rem);}
footer{opacity:.8; text-align:center; font-size:.83em; margin:19px auto 3px auto; color:var(--muted);}
@media (max-width:900px){
  .split-container{flex-direction:column; min-height:350px; height:auto;}
  .split-side{min-height: 148px;}
  .stage-outer{height: 98px;}
}
</style>
</head>
<body>
<div style="text-align:center; margin-bottom:8px;"><img src="GSU_LOGO.png" alt="GSU" style="max-width:69px;vertical-align:middle;"> <span style="letter-spacing:2px;font-size:1.12em;vertical-align:middle;">GSU COMMAND STRIKE ‚Äî SPLIT DUEL</span></div>

<div class="split-container">
  <div class="split-side left">
    <h2>üë§ YOU</h2>
    <div class="hud" id="hud-player">
      <div class="pill">Round <strong id="p-round">1</strong>/12</div>
      <div class="pill">Time <strong id="p-time">0</strong>ms</div>
      <div class="pill">Combo <strong id="p-streak">0</strong></div>
      <div class="pill">Progress <strong id="p-prog">0</strong>%</div>
      <div class="pill">Hits <strong id="p-hits">0</strong></div>
    </div>
    <div class="cmd" id="p-cmd"></div>
    <div class="stage-outer"><div class="fx" id="fx-player"></div></div>
    <div id="player-leader" class="leader"></div>
    <div class="letters" id="letters-player"></div>
  </div>
  <div class="split-side right">
    <h2>ü§ñ CPU</h2>
    <div class="hud" id="hud-cpu">
      <div class="pill">Round <strong id="c-round">1</strong>/12</div>
      <div class="pill">Time <strong id="c-time">0</strong>ms</div>
      <div class="pill">Progress <strong id="c-prog">0</strong>%</div>
      <div class="pill">Hits <strong id="c-hits">0</strong></div>
      <div class="pill">Streak <strong id="c-streak">0</strong></div>
    </div>
    <div class="cmd" id="c-cmd"></div>
    <div class="stage-outer"><div class="fx" id="fx-cpu"></div></div>
    <div id="cpu-leader" class="leader"></div>
  </div>
</div>

<div class="directions">
  <div class="key" data-sym="‚Üë">‚Üë</div>
  <div class="key" data-sym="‚Üê">‚Üê</div>
  <div class="key" data-sym="‚Üì">‚Üì</div>
  <div class="key" data-sym="‚Üí">‚Üí</div>
</div>
<div class="letters" id="lettersRow"></div>
<div class="btnRow">
  <button class="btn" id="start">‚ñ∂ Start Drill</button>
  <button class="btn" id="next" disabled>‚è≠ Next Pattern</button>
  <button class="btn" id="restart" disabled>üîÅ Restart</button>
</div>
<div style="margin-top:11px; color:var(--muted); font-size:.95em;text-align:center;">Arrows=move. Beat the CPU to win the round!</div>
<div class="overlay" id="overlay"></div>
<footer>Built for GameSync Union ‚Äî GSU Command Strike‚Ñ¢</footer>
<script>
const DIR = ["‚Üë","‚Üì","‚Üê","‚Üí"];
const LETTER_TOKENS = []; // Disable letters
const MAX_ROUNDS = 12;
const BOOM_ICONS = [
  'üí•','‚ú®','‚ö°','üî•','üí£','üéÜ','üéá','üß®','üå©Ô∏è','üåü','‚òÑÔ∏è','üí´',
  'üåã','üåÄ','‚≠ê','üå†','üå™Ô∏è','‚ú¥Ô∏è','‚ú≥Ô∏è','‚ùáÔ∏è','‚ú∫','‚úπ','‚ú∏','‚úª'
];
const BOOM_KEYFRAMES = [
  [{opacity:0.1},{opacity:1},{opacity:0}],
  [{transform:'rotate(0deg) scale(0.3)',opacity:0.2},{transform:'rotate(20deg) scale(0.6)',opacity:1},{transform:'rotate(40deg) scale(0)',opacity:0}],
  [{transform:'scale(0.5) translateX(-20px)',opacity:0.3},{transform:'scale(1) translateX(10px)',opacity:1},{transform:'scale(1.2) translateX(30px)',opacity:0}],
];

function pick(arr){return arr[Math.floor(Math.random()*arr.length)]}
function rand(a,b){return Math.random()*(b-a)+a}

function spawnTargetFX(stage,fx,existing=[]) {
  const rect = stage.getBoundingClientRect(), pad = 18;
  const size = 38;
  let x, y, tries = 0;
  do {
    x = rand(pad, rect.width - pad - size);
    y = rand(pad, rect.height - pad - size);
    tries++;
    const overlap = existing.some(t => Math.abs(x - t.x) < size && Math.abs(y - t.y) < size);
    if(tries > 100) break;
  } while(overlap);
  const el = document.createElement('div');
  el.className='target';
  el.style.transform = `translate(${x}px,${y}px)`;
  el.textContent = pick([
    'üëæ', 'üòÇ','üòà','ü§°','üôÑ','‚ò†Ô∏è','ü§™','ü§¨','ü§ë','üò¥','üë∫',
    'üêí','ü¶Ö','üê∏','üê∑','üêä','üê∞','üêâ','ü¶ä','üòç','ü•∏','üëª',
    'ü¶Å','ü¶Ñ','üò±','üê¶‚Äçüî•','üê≤','üòé','ü§©','üòò']);
  fx.appendChild(el);
  return {x,y,el};
}

function flyControllerFX(stage, fx, target, cb) {
  const img = document.createElement('img');
  img.src = "GSU_LOGO.png";
  img.className = "controller";
  fx.appendChild(img);
  const tx = target.x, ty = target.y, sx = rand(-66, 2), sy = rand(18, stage.clientHeight - 30);
  const kf = [
    {transform: `translate(${sx}px,${sy}px) scale(1)`},
    {transform: `translate(${(sx + tx) / 2}px,${(sy + ty) / 2 - 25}px) scale(1.08)`},
    {transform: `translate(${tx}px,${ty}px) scale(1.10)`}
  ];
  img.animate(kf, {duration: 350, easing: 'cubic-bezier(.2,.7,.2,1)', fill: 'forwards'}).onfinish = () => {
    setTimeout(() => { // 120ms delay before boom effect
      const boom = document.createElement('div');
      boom.className = "boom";
      boom.textContent = pick(BOOM_ICONS);
      boom.style.transform = `translate(${tx + rand(-7, 7)}px,${ty + rand(-7,7)}px) scale(0.6)`;
      fx.appendChild(boom);
      boom.animate(pick(BOOM_KEYFRAMES), {duration: 320, fill: 'forwards'}).onfinish = () => boom.remove();
      confettiFX(stage, fx, tx, ty, 6 + Math.floor(Math.random()*2));
    }, 120);
    target.el.classList.add("hit");
    setTimeout(() => { target.el && target.el.remove(); }, 160);
    if(cb) cb();
    img.remove();
  };
}

// Rest of functions: confettiFX, spawnSparkFX, genPattern, tokenLengthByRound, apply, etc.
// See above code; no letter commands, arrows only for input.

function confettiFX(stage, fx, x, y, n) {
  for(let i=0; i<n; i++) {
    const c = document.createElement("div");
    c.className = "confetti";
    c.style.background = pick(["#e60023","#22cc88","#33aaff","#ffcc33","#dd66ff","#ffffff"]);
    const sx = x + rand(-10,10), sy = y + rand(-7,7), th = stage.clientHeight;
    c.style.transform = `translate(${sx}px,${sy}px) rotate(${rand(0,360)}deg)`;
    fx.appendChild(c);
    c.animate([
      {transform: `translate(${sx}px,${sy}px)`, opacity: 1},
      {transform: `translate(${sx + rand(-38,38)}px,${th + 18}px) rotate(${rand(180,720)}deg)`, opacity: 0.05}
    ], {duration: rand(620,950), easing: "cubic-bezier(.2,.7,.2,1)", fill: "forwards"}).onfinish = () => c.remove();
  }
}

// Continue with your existing logic for newGame, startRound, endRound, apply, startCPU, checkWinner, showBanner, setHUD, leadingUpdate, keyboard and click listeners...

// Keyboard and button event codes unchanged except letters removed from input:

window.addEventListener("keydown", (e) => {
  if(["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight"].includes(e.key)) e.preventDefault();
  let sym = null;
  if (e.key === "ArrowUp") sym = "‚Üë";
  else if (e.key === "ArrowDown") sym = "‚Üì";
  else if (e.key === "ArrowLeft") sym = "‚Üê";
  else if (e.key === "ArrowRight") sym = "‚Üí";
  if (sym && DIR.includes(sym)) apply(sym);
});

[...document.querySelectorAll(".key[data-sym]")].forEach((k) => {
  k.addEventListener("click", () => apply(k.getAttribute("data-sym")));
});

startBtn.addEventListener("click", () => {
  ensureAudio();
  if (!game) game = newGame();
  else game.round = 1;
  startRound();
});

nextBtn.addEventListener("click", () => {
  game.round++;
  startRound();
});

restartBtn.addEventListener("click", () => {
  if (game) startRound();
});
</script>
</body>
</html>
