<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>GSU Command Strike — Solo</title>
<link rel="icon" href="GSU_LOGO.png" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet" />
<style>
  :root{ --gsu-red:#e60023; --bg:#000; --fg:#fff; --muted:#c7c7c7 }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:'Orbitron',sans-serif; background:var(--bg); color:var(--fg);
    min-height:100vh; display:flex; flex-direction:column; align-items:center; gap:16px;
    padding: calc(16px + env(safe-area-inset-top)) 16px calc(16px + env(safe-area-inset-bottom));
    touch-action:manipulation;
  }
  header{display:flex; flex-direction:column; align-items:center; gap:8px}
  .logo{max-width:100px}
  .wrap{
    width:min(960px,96vw); border:3px solid var(--gsu-red); border-radius:16px; padding:14px;
    box-shadow:0 0 18px #e60023cc, inset 0 0 18px #e6002326; background:linear-gradient(#0a0a0a,#000);
  }
  .hud{display:grid; grid-template-columns:repeat(5,1fr); gap:8px; margin-bottom:10px; font-size:clamp(.85rem,2vw,1rem)}
  .pill{background:#111; border:1px solid #2a2a2a; border-radius:10px; padding:8px; text-align:center}
  .pill strong{color:var(--gsu-red)}

  .panel{border:1px solid #2a2a2a; border-radius:12px; padding:12px; background:#0b0b0b; display:flex; flex-direction:column; gap:12px;}
  .stage{position:relative; height:clamp(140px,28dvh,200px); border:1px solid #333; border-radius:12px; background:#0f0f0f; overflow:hidden}
  .fx{position:absolute; inset:0; pointer-events:none}
  .target{position:absolute; font-size:52px; filter:drop-shadow(0 0 8px #fff)}
  .target.hit{filter:drop-shadow(0 0 14px #e60023)}
  .controller{position:absolute; width:64px; will-change:transform; filter:drop-shadow(0 0 8px rgba(230,0,35,.6))}
  .boom{position:absolute; font-size:64px; opacity:0}

  .big-next{text-align:center; font-size:clamp(1.1rem,4.5vw,1.6rem); background:#0f0f0f; border:1px solid #333; border-radius:12px; padding:12px;}
  .cmd{background:#0f0f0f; border:1px dashed #444; border-radius:12px; padding:12px; min-height:80px; display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:center;}
  .token{padding:10px 12px; border-radius:10px; background:#171717; border:1px solid #333; font-size:1.05rem}
  .token.pending{outline:2px solid #ffae00}
  .token.ok{outline:2px solid #29d07a}
  .token.bad{outline:2px solid #d02121}

  .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:center}
  .btn{border:none; background:var(--gsu-red); color:#fff; padding:10px 16px; border-radius:10px; cursor:pointer; box-shadow:0 0 10px #e60023aa; font-weight:700}
  .btn:disabled{opacity:.6; cursor:not-allowed}
  .hint{color:var(--muted); text-align:center; font-size:.95rem}

  .controls{margin-top:6px; display:grid; grid-template-columns:repeat(3,64px); gap:8px; justify-content:center; align-items:center; user-select:none}
  .key{width:64px; height:64px; border-radius:12px; background:#121212; border:1px solid #333; display:flex; align-items:center; justify-content:center; font-size:1.2rem; cursor:pointer; box-shadow:0 0 8px rgba(255,255,255,.05)}
  .key:active{filter:brightness(1.2)}
  .letters{display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-top:6px}
  .letters .key{width:48px; height:44px}

  .overlay{position:absolute; inset:0; display:flex; align-items:center; justify-content:center; pointer-events:none; font-weight:800; letter-spacing:1px;}
  .banner{padding:10px 16px; border:2px solid #fff; border-radius:14px; background:rgba(230,0,35,.15); text-shadow:0 0 12px rgba(255,255,255,.45); font-size:clamp(1.2rem,4.5vw,2rem); transform:scale(.8); opacity:0;}
  .wrap.shake{animation:shake .3s ease}
  @keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-4px)}50%{transform:translateX(4px)}75%{transform:translateX(-4px)}}
  .compact .hud{grid-template-columns:repeat(2,1fr)}
  .compact .key{width:52px;height:52px}
  .compact .letters .key{width:40px;height:38px;font-size:1rem}
</style>
<script>
  (function(){const apply=()=>{const h=(visualViewport?.height??innerHeight),w=(visualViewport?.width??innerWidth);document.documentElement.classList.toggle('compact', w<420||h<720);};addEventListener('resize',apply,{passive:true});addEventListener('orientationchange',apply,{passive:true});addEventListener('DOMContentLoaded',apply,{once:true});})();
</script>
</head>
<body>
  <header>
    <img class="logo" src="GSU_LOGO.png" alt="GSU">
    <div>GAMESYNC UNION</div>
  </header>

  <section class="wrap" id="wrap">
    <h1 style="margin:6px 0 10px 6px;">GSU COMMAND STRIKE — SOLO</h1>
    <div class="hud">
      <div class="pill">📜 Round <strong id="round">1</strong>/12</div>
      <div class="pill">🎯 Progress <strong id="progress">0</strong>%</div>
      <div class="pill">⏱ Time <strong id="time">0</strong>ms</div>
      <div class="pill">✅ Accuracy <strong id="acc">0</strong>%</div>
      <div class="pill">🔥 Streak <strong id="streak">0</strong></div>
    </div>

    <div class="panel">
      <div class="stage" id="stage">
        <div class="fx" id="fx"></div>
        <div class="overlay"><div class="banner" id="banner">ROUND CLEAR!</div></div>
      </div>

      <div class="big-next">Next: <span id="nextToken">—</span></div>
      <div class="cmd" id="cmd"></div>

      <div class="row">
        <button class="btn" id="start">▶ Start Drill</button>
        <button class="btn" id="next" disabled>⏭ Next Pattern</button>
        <button class="btn" id="restart" disabled>🔁 Restart</button>
      </div>

      <div class="hint">Arrows = directions • Letters A/S/D/Q/E/F/J/K/L/Z/X/C/W/R/U/I (press the same letter)</div>

      <div class="controls" aria-label="D-Pad">
        <div></div><div class="key" data-sym="↑">↑</div><div></div>
        <div class="key" data-sym="←">←</div><div class="key" data-sym="↓">↓</div><div class="key" data-sym="→">→</div>
      </div>
      <div class="letters" id="lettersRow"></div>
    </div>
  </section>

<script>
/* ---------- Tokens & Pattern ---------- */
const DIR = ["↑","↓","←","→"];
const LETTER_TOKENS = ["A","S","D","Q","E","F","J","K","L","Z","X","C","W","R","U","I"];
const MAX_ROUNDS = 12;
const pick = (arr)=>arr[Math.floor(Math.random()*arr.length)];
function tokenLengthByRound(r){ return [4,4,5,5,6,6,6,7,7,7,8,8][Math.min(MAX_ROUNDS-1, Math.max(0, r-1))]; }
function genPattern(round){
  const len = tokenLengthByRound(round), toks=[];
  for(let i=0;i<len;i++){
    const pool = Math.random()<0.5 ? DIR : LETTER_TOKENS;
    let t = pick(pool);
    if(i>0 && t===toks[i-1]) t = pick(pool.filter(x=>x!==t));
    toks.push(t);
  }
  return toks;
}

/* ---------- DOM ---------- */
const wrap = document.getElementById('wrap');
const stage = document.getElementById('stage');
const fx = document.getElementById('fx');
const banner = document.getElementById('banner');
const roundEl=document.getElementById('round'), progEl=document.getElementById('progress'), timeEl=document.getElementById('time'), accEl=document.getElementById('acc'), streakEl=document.getElementById('streak');
const cmdEl=document.getElementById('cmd'), nextTok=document.getElementById('nextToken');
const startBtn=document.getElementById('start'), nextBtn=document.getElementById('next'), restartBtn=document.getElementById('restart');
const lettersRow=document.getElementById('lettersRow');
lettersRow.innerHTML = LETTER_TOKENS.map(ch=>`<div class="key" data-sym="${ch}">${ch}</div>`).join("");

/* ---------- State ---------- */
let game=null;
function newGame(){ return {round:1,maxRounds:MAX_ROUNDS,tokens:[],idx:0,start:0,end:0,hits:0,presses:0,streak:0,active:false}; }

/* ---------- UI ---------- */
function renderCmd(){
  cmdEl.innerHTML = game.tokens.map((t,i)=>`<div class="token ${i<game.idx?'ok':i===game.idx?'pending':''}">${t}</div>`).join("");
  nextTok.textContent = game.tokens[game.idx] ?? "—";
}
function setHUD(){
  roundEl.textContent = game.round;
  const p = game.tokens.length ? Math.floor(100 * (game.idx / game.tokens.length)) : 0;
  progEl.textContent = p;
  const t = game.end && game.start ? (game.end - game.start) : (performance.now() - game.start);
  timeEl.textContent = game.active ? Math.floor(t) : Math.floor(game.end - game.start);
  const acc = game.presses ? Math.floor(100 * (game.hits / game.presses)) : 0;
  accEl.textContent = acc;
  streakEl.textContent = game.streak;
}

/* ---------- Targets & FX ---------- */
const BOOM_ICONS = [
  "💥","✨","⚡","🔥","💣","🎆","🎇","🧨","🌩️","🌟","☄️","💫","🌋","🌀","⭐","🌠","🌪️","✴️","❇️","✹",
  "💥✨","⚡💥","🔥💥","🎆💥","🎇✨","🧨💥","💣💥","🌩️⚡","☄️💥","🌋🔥","🌟✨","⭐✨","🌠✨","💫✨","⚡🔥","✨⚡",
  "💥💥💥","✨✨✨","⚡⚡⚡","🔥🔥🔥","🎆🎆🎆","🎇🎇🎇","🧨🧨🧨"
];
let currentTarget=null;
const rand=(a,b)=>Math.random()*(b-a)+a, clamp=(v,mn,mx)=>Math.max(mn,Math.min(mx,v));

function spawnTarget(){
  fx.innerHTML=""; banner.style.opacity=0;
  const rect=stage.getBoundingClientRect(); const pad=24;
  const x=rand(pad, rect.width - pad - 52), y=rand(pad, rect.height - pad - 52);
  const t=document.createElement('div'); t.className='target'; t.style.transform=`translate(${x}px,${y}px)`; t.textContent=pick(['🎮','🕹️','👾','💿','🧩','🎯','🛡️','🗡️','🏆','🪙']);
  fx.appendChild(t); return {x,y,el:t};
}
function flyController(keyframes,onHit){
  const logo=document.createElement('img'); logo.src='GSU_LOGO.png'; logo.alt='GSU'; logo.className='controller'; fx.appendChild(logo);
  if(!keyframes[0]?.transform) keyframes[0]={transform:`translate(-90px, ${rand(80,160)}px) rotate(-15deg) scale(1)`};
  logo.animate(keyframes,{duration:900,easing:'cubic-bezier(.2,.7,.2,1)',fill:'forwards'}).onfinish=()=>{
    const t=currentTarget?.el; if(t) t.classList.add('hit');
    const boom=document.createElement('div'); boom.className='boom'; boom.textContent=pick(BOOM_ICONS);
    const bx=(currentTarget?.x??120)+rand(-8,8), by=(currentTarget?.y??24)+rand(-8,8);
    boom.style.transform=`translate(${bx}px,${by}px) scale(.6)`; fx.appendChild(boom);
    boom.animate([{opacity:.1,transform:`translate(${bx}px,${by}px) scale(.6)`},{opacity:1,transform:`translate(${bx}px,${by}px) scale(1.25)`}],{duration:380,easing:'ease-out',fill:'forwards'});
    wrap.classList.add('shake'); setTimeout(()=>wrap.classList.remove('shake'),380);
    onHit&&onHit();
    const rect=stage.getBoundingClientRect(); const parkX=pick([rand(-10,10), rand(rect.width-70, rect.width-40)]); const parkY=rand(8, rect.height-70);
    logo.animate([{transform:getComputedStyle(logo).transform,opacity:1},{transform:`translate(${parkX}px,${parkY}px) scale(.85)`,opacity:.0}],{duration:520,easing:'ease-out',fill:'forwards'}).onfinish=()=>{logo.remove(); boom.remove(); t&&t.remove();};
  };
}
function variantArc(){const sx=-90,sy=rand(80,160); const tx=(currentTarget?.x??220),ty=(currentTarget?.y??40); const midx=(sx+tx)/2+rand(-40,40), midy=Math.min(sy,ty)-rand(30,70); return [{transform:`translate(${sx}px,${sy}px) rotate(-10deg) scale(1)`},{transform:`translate(${midx}px,${midy}px) rotate(5deg) scale(1.05)`},{transform:`translate(${tx}px,${ty}px) rotate(12deg) scale(1.1)`}];}
function variantZig(){const tx=(currentTarget?.x??220),ty=(currentTarget?.y??40); const sx=rand(-70,20),sy=rand(40,150),kf=[],steps=4; for(let i=0;i<=steps;i++){const u=i/steps,x=sx+(tx-sx)*u+(i%2?18:-18),y=sy+(ty-sy)*u+(i%2?-12:12); kf.push({transform:`translate(${x}px,${y}px) rotate(${i*8-12}deg) scale(${1+u*0.15})`});} return kf;}
function variantSpin(){const tx=(currentTarget?.x??220),ty=(currentTarget?.y??40); const sx=rand(40, stage.clientWidth-80),sy=-100; return [{transform:`translate(${sx}px,${sy}px) rotate(-360deg) scale(.9)`},{transform:`translate(${sx}px,${ty-30}px) rotate(-90deg) scale(1)`},{transform:`translate(${tx}px,${ty}px) rotate(0deg) scale(1.1)`}];}
function variantBoom(){const tx=(currentTarget?.x??220),ty=(currentTarget?.y??40); const sx=stage.clientWidth+50,sy=rand(40,150); const overX=clamp(tx+rand(40,90),0,stage.clientWidth-60); return [{transform:`translate(${sx}px,${sy}px) rotate(15deg) scale(1)`},{transform:`translate(${overX}px,${ty-10}px) rotate(-10deg) scale(1.05)`},{transform:`translate(${tx}px,${ty}px) rotate(0deg) scale(1.1)`}];}
function variantRain(){ for(let i=0;i<6;i++){const mini=document.createElement('img'); mini.src='GSU_LOGO.png'; mini.alt='GSU'; mini.className='controller'; mini.style.width='40px'; fx.appendChild(mini); const sx=rand(0,stage.clientWidth-50), sy=-rand(30,140), ey=stage.clientHeight-rand(30,80); mini.animate([{transform:`translate(${sx}px,${sy}px)`,opacity:.9},{transform:`translate(${sx+rand(-20,20)}px,${ey}px)`,opacity:.2}],{duration:rand(600,900),easing:'ease-in',fill:'forwards'}).onfinish=()=>mini.remove(); } const tx=(currentTarget?.x??220),ty=(currentTarget?.y??40); const sx=-80,sy=rand(40,150); return [{transform:`translate(${sx}px,${sy}px) rotate(-5deg) scale(1)`},{transform:`translate(${tx}px,${ty}px) rotate(8deg) scale(1.08)`}];}
function playStrike(){const variants=[variantArc,variantZig,variantSpin,variantBoom,variantRain]; flyController(pick(variants)());}

/* ---------- Flow ---------- */
function startRound(){
  game.active=true; game.tokens=genPattern(game.round);
  game.idx=0; game.hits=0; game.presses=0; game.streak=0; game.start=performance.now(); game.end=0;
  renderCmd(); setHUD(); startBtn.disabled=true; nextBtn.disabled=true; restartBtn.disabled=false;
  currentTarget=spawnTarget();
}
function endRound(){
  game.active=false; game.end=performance.now(); setHUD(); playStrike();
  banner.animate([{opacity:0,transform:'scale(.8)'},{opacity:1,transform:'scale(1)'}],{duration:300,fill:'forwards',easing:'ease-out'});
  if(game.round>=game.maxRounds){ startBtn.disabled=false; startBtn.textContent='🔁 New Drill'; nextBtn.disabled=true; } else { nextBtn.disabled=false; }
}
function nextRound(){ game.round++; startRound(); }

/* ---------- Inputs ---------- */
function apply(sym){
  if(!game?.active) return; game.presses++;
  const need=game.tokens[game.idx];
  if(sym===need){
    game.hits++; game.streak=Math.min(999,game.streak+1); game.idx++; renderCmd(); setHUD();
    if(game.idx>=game.tokens.length) endRound();
  } else {
    game.streak=0;
    const cur=cmdEl.querySelectorAll('.token')[game.idx]; if(cur){ cur.classList.add('bad'); setTimeout(()=>cur.classList.remove('bad'),140); }
    setHUD();
  }
}
function onKey(e){
  if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," "].includes(e.key)) e.preventDefault();
  if(!game) return;
  let sym=null;
  if(e.key==="ArrowUp") sym="↑"; else if(e.key==="ArrowDown") sym="↓"; else if(e.key==="ArrowLeft") sym="←"; else if(e.key==="ArrowRight") sym="→";
  else if(/^[a-z]$/i.test(e.key)) sym=e.key.toUpperCase();
  if(sym && (DIR.includes(sym) || LETTER_TOKENS.includes(sym))) apply(sym);
}
window.addEventListener('keydown', onKey);
document.querySelectorAll('.key[data-sym]').forEach(k=>k.addEventListener('click',()=>apply(k.getAttribute('data-sym'))));

/* Buttons */
startBtn.addEventListener('click', ()=>{ if(!game) game=newGame(); else game.round=1; startRound(); });
nextBtn.addEventListener('click', nextRound);
restartBtn.addEventListener('click', ()=>{ if(game) startRound(); });
</script>
</body>
</html>
